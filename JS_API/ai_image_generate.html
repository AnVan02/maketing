<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>API Image Searching</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

    <h3>Tìm kiếm hình ảnh dựa trên từ khóa</h3>

    <input 
        type="text" 
        id="keyword" 
        placeholder="Nhập từ khóa tìm kiếm (ví dụ: ảnh chó)"
        style="width: 300px; padding: 5px;"
    />

    <button onclick="ImageSearching()">Tìm kiếm</button>

    <hr>

    <div id="result"></div>

    <script>
        async function ImageSearching() {
            const keywordInput = document.getElementById("keyword");
            const keyword = keywordInput.value.trim();

            if (!keyword) {
                alert("Vui lòng nhập từ khóa tìm kiếm");
                return;
            }

            const resultDiv = document.getElementById("result");
            resultDiv.innerHTML = "<p>Đang tìm kiếm...</p>";

            try {
                const response = await fetch(
                    "https://caiman-warm-swan.ngrok-free.app/api/v1/crawl/images",
                    {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            query: keyword,
                            num_results: 10
                        })
                    }
                );

                const data = await response.json();
                resultDiv.innerHTML = "";

                if (!data.success) {
                    resultDiv.innerHTML = `
                        <p style="color:red;">
                            ${data.message || "Search failed"}
                        </p>
                    `;
                    return;
                }

                resultDiv.innerHTML = `
                    <p>
                        Tìm thấy ${data.total_results} hình ảnh cho 
                        "<strong>${data.query}</strong>"
                    </p>
                `;

                data.images.forEach(img => {
                    const imgEl = document.createElement("img");
                    imgEl.src = img.image_url;
                    imgEl.alt = img.title || "";
                    imgEl.style.width = "200px";
                    imgEl.style.margin = "5px";
                    imgEl.style.objectFit = "cover";
                    resultDiv.appendChild(imgEl);
                });

            } catch (error) {
                resultDiv.innerHTML = `
                    <p style="color:red;">
                        Lỗi gọi API: ${error.message}
                    </p>
                `;
            }
        }
    </script>

</body>
</html>
