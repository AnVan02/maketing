<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Crawl News API</title>
</head>

<body>

    <h3>Lấy tin tức theo từ khóa</h3>

    <input type="text" id="keyword" value="chatgpt 5.0 có gì mới ?" style="width:300px">
    <button onclick="searchNews()">Tìm kiếm</button>

    <hr>
    <div id="result"></div>

    <script>
        async function searchNews() {
            const keyword = document.getElementById("keyword").value;

            const response = await fetch("https://caiman-warm-swan.ngrok-free.app/api/v1/crawl/news", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    query: keyword,
                    max_results: 2
                })
            });

            const data = await response.json();

            // Hiển thị raw JSON
            console.log(data);

            // Kiểm tra success
            if (!data.success) {
                document.getElementById("result").innerHTML = "API lỗi!";
                return;
            }

            let html = "";
            html += "<b>Từ khóa:</b> " + data.query + "<br>";
            html += "<b>Tổng kết quả:</b> " + data.total_results + "<hr>";

            data.results.forEach((item, index) => {
                html += "<b>Bài " + (index + 1) + "</b><br>";
                html += "Tiêu đề: " + item.title + "<br>";
                html += "Link: <a href='" + item.url + "' target='_blank'>" + item.url + "</a><br>";
                html += "Mô tả: " + item.snippet + "<br><hr>";
            });

            document.getElementById("result").innerHTML = html;
        }
    </script>

</body>

</html>